<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>API para Zuplo </title>
    <link rel="stylesheet" href="estilo.css">
</head>
<body>

    <h1>Test API</h1>
    
    <!-- Sección para Guardar -->
    <div>
        <input type="text" id="nuevoTexto" placeholder="Escribe algo...">
        <button onclick="guardarMensaje()">Guardar en DB</button>
    </div>

    <hr>

    <!-- Sección para Ver -->
    <button onclick="cargarMensajes()" style="background: #28a745;">Actualizar Lista</button>
    <div id="listaMensajes"></div>

    <script>
        const API_URL = 'http://localhost:9000/api/mensajes';

        // FUNCIÓN 1: Guardar datos (POST)
        async function guardarMensaje() {
            const input = document.getElementById('nuevoTexto');
            if (!input.value) return alert("Escribe algo");

            await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ texto: input.value})
            });

            input.value = ''; // Limpiar campo
            cargarMensajes(); // Actualizar lista automáticamente
        }

        // FUNCIÓN 2: Obtener datos (GET)
        async function cargarMensajes() {
            const res = await fetch(API_URL);
            const mensajes = await res.json();
            
            const contenedor = document.getElementById('listaMensajes');
            contenedor.innerHTML = mensajes.map(m => 
                `<div class="mensaje-item">${m.texto}</div>`
            ).reverse().join('');
        }

        // Cargar al iniciar
        cargarMensajes();
    </script>
</body>
</html>
